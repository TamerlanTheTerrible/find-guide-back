<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide Finder WebApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- calendar -->
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../calendar-07/css/style.css">
    <style>
        /*html * {*/
        /*    padding: 0;*/
        /*    margin: 0;*/
        /*    box-sizing: border-box;*/
        /*}*/
        /*body {*/
        /*    background-color: #262626;*/
        /*    display: flex;*/
        /*    justify-content: center;*/
        /*    align-items: center;*/
        /*    height: 100vh;*/
        /*    font-family: sans-serif;*/
        /*    padding: 5rem;*/
        /*}*/

        /*details {*/
        /*    position: relative;*/
        /*    width: 300px;*/
        /*    margin-right: 1rem;*/
        /*}*/

        /*details[open] {*/
        /*    z-index: 1;*/
        /*}*/

        /*summary {*/
        /*    padding: 1rem;*/
        /*    cursor: pointer;*/
        /*    border-radius: 5px;*/
        /*    background-color: #ddd;*/
        /*    list-style: none;*/
        /*}*/

        /*summary::-webkit-details-marker {*/
        /*    display: none;*/
        /*}*/

        /*details[open] summary:before {*/
        /*    content: '';*/
        /*    display: block;*/
        /*    width: 100vw;*/
        /*    height: 100vh;*/
        /*    background: transparent;*/
        /*    position: fixed;*/
        /*    top: 0;*/
        /*    left: 0;*/
        /*}*/

        /*summary:after {*/
        /*    content: '';*/
        /*    display: inline-block;*/
        /*    float: right;*/
        /*    width: .5rem;*/
        /*    height: .5rem;*/
        /*    border-bottom: 1px solid currentColor;*/
        /*    border-left: 1px solid currentColor;*/
        /*    border-bottom-left-radius: 2px;*/
        /*    transform: rotate(45deg) translate(50%, 0%);*/
        /*    transform-origin: center center;*/
        /*    transition: transform ease-in-out 100ms*/
        /*}*/

        /*summary:focus {*/
        /*    outline: none;*/
        /*}*/

        /*details[open] summary:after {*/
        /*    transform: rotate(-45deg) translate(0%, 0%);*/
        /*}*/

        /*ul {*/
        /*    width: 100%;*/
        /*    background: #ddd;*/
        /*    position: absolute;*/
        /*    top: calc(100% + .5rem);*/
        /*    left: 0;*/
        /*    padding: 1rem;*/
        /*    margin: 0;*/
        /*    box-sizing: border-box;*/
        /*    border-radius: 5px;*/
        /*    max-height: 200px;*/
        /*    overflow-y: auto;*/
        /*}*/

        /*li {*/
        /*    margin: 0;*/
        /*    padding: 1rem 0;*/
        /*    border-bottom: 1px solid #ccc;*/
        /*}*/

        /*li:first-child {*/
        /*    padding-top: 0;*/
        /*}*/

        /*li:last-child {*/
        /*    padding-bottom: 0;*/
        /*    border-bottom: none;*/
        /*}*/

        /*!* FAKE SELECT *!*/

        /*summary.radios {*/
        /*    counter-reset: radios;*/
        /*}*/

        /*summary.radios:before {*/
        /*    content: var(--selection);*/
        /*}*/

        /*input[type=radio] {*/
        /*    counter-increment: radios;*/
        /*    appearance: none;*/
        /*    display: none;*/
        /*}*/

        /*input[type=radio]:checked {*/
        /*    display: inline;*/
        /*    --display: block;*/
        /*}*/

        /*input[type=radio]:after {*/
        /*    content: attr(title);*/
        /*    display: inline;*/
        /*    font-size: 1rem;*/
        /*}*/

        /*ul.list {*/
        /*    counter-reset: labels;*/
        /*}*/

        /*ul {*/
        /*    list-style: none;*/
        /*}*/

        /*label {*/
        /*    width: 100%;*/
        /*    display: flex;*/
        /*    cursor: pointer;*/
        /*    justify-content: space-between;*/
        /*}*/

        /*label span {*/
        /*    --display: none;*/
        /*    display: var(--display);*/
        /*    width: 1rem;*/
        /*    height: 1rem;*/
        /*    border: 1px solid #727272;*/
        /*    border-radius: 3px;*/
        /*}*/
    </style>
</head>

<body>
<div id="guideForm">
    <!--     calendar-->
    <div class="calendar">
        <div class="row justify-content-center">
            <div class="col-md-6 text-center mb-5">
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="elegant-calencar d-md-flex">
                    <div class="wrap-header d-flex align-items-center img" style="background-image: url(../calendar-07/images/bg.jpg);">
                        <p id="reset">Today</p>
                        <div id="header" class="p-0">
                            <!-- <div class="pre-button d-flex align-items-center justify-content-center"><i class="fa fa-chevron-left"></i></div> -->
                            <div class="head-info">
                                <div class="head-month"></div>
                                <div class="head-day"></div>
                            </div>
                            <!-- <div class="next-button d-flex align-items-center justify-content-center"><i class="fa fa-chevron-right"></i></div> -->
                        </div>
                    </div>
                    <div class="calendar-wrap">
                        <div class="w-100 button-wrap">
                            <div class="pre-button d-flex align-items-center justify-content-center"><i class="fa fa-chevron-left"></i></div>
                            <div class="next-button d-flex align-items-center justify-content-center"><i class="fa fa-chevron-right"></i></div>
                        </div>
                        <table id="calendar">
                            <thead>
                            <tr>
                                <th>Sun</th>
                                <th>Mon</th>
                                <th>Tue</th>
                                <th>Wed</th>
                                <th>Thu</th>
                                <th>Fri</th>
                                <th>Sat</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>


<!--    <details class="custom-select">-->
<!--        <summary class="radios">-->
<!--            <input type="radio" name="item" id="default" title="choose language" checked>-->
<!--            <input type="radio" name="item" id="Uzbekistan" title="Uzbekistan">-->
<!--            <input type="radio" name="item" id="Tashkent" title="Tashkent">-->
<!--            <input type="radio" name="item" id="Samarkand" title="Samarkand">-->
<!--            <input type="radio" name="item" id="Bukhara" title="Bukhara">-->
<!--        </summary>-->
<!--        <ul class="list">-->
<!--            <li>-->
<!--                <label for="Uzbekistan">Uzbekistan-->
<!--                    <span></span>-->
<!--                </label>-->
<!--            </li>-->
<!--            <li>-->
<!--                <label for="Tashkent">Tashkent</label>-->
<!--            </li>-->
<!--            <li>-->
<!--                <label for="Samarkand">Samarkand</label>-->
<!--            </li>-->
<!--            <li>-->
<!--                <label for="Bukhara">Bukhara</label>-->
<!--            </li>-->
<!--        </ul>-->
<!--    </details>-->
</div>
<script>
    let fromDate = document.getElementById("fromDate");
    let toDate = document.getElementById("toDate");
    let language = document.getElementById("language");
    let region = document.getElementById("region");
    let hasCar = document.getElementById("hasCar");
    let comments = document.getElementById("comment");

    let tg = window.Telegram.WebApp;

    tg.MainButton.text = "Search"; //изменяем текст кнопки
    tg.MainButton.enable()
    tg.MainButton.show()

    Telegram.WebApp.onEvent('mainButtonClicked', function(){
        sendData();
    });

    function sendData() {
        let initDataURLSP = new URLSearchParams(tg.initData);
        let userStr = initDataURLSP.get('user');
        let user = JSON.parse(userStr);

        // Create an object with the search parameters
        let searchParams = {
            // user_id: userId.value,
            telegram_id: user.id,
            from_date: fromDate.value,
            to_date: toDate.value,
            language: language.value,
            region: region.value,
            has_car: hasCar.checked,
            comment: comments.value
        };

        fetch('https://still-beyond-67512-6a27447420c3.herokuapp.com/guide-search', {
        // fetch('http://127.0.0.1:8280/guide-search/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(searchParams)
        })
            .then(response => response.json())
            .then(data => {
                console.log('Response: ', data);
                tg.showPopup(data)
            })
            .catch(error => {
                console.error('Error: ', error);
                tg.showAlert("Error: ", error)
            });
    }
</script>
<script src="../calendar-07/js/jquery.min.js"></script>
<script src="../calendar-07/js/popper.js"></script>
<script src="../calendar-07/js/bootstrap.min.js"></script>
<script src="../calendar-07/js/main.js"></script>
</body>
</html>

